<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Things to do to finish the package/paper/project • rubias</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Things to do to finish the package/paper/project"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rubias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/rubias-fully-bayesian.html">Using the Fully Bayesian Model in rubias</a></li>
    <li><a class="dropdown-item" href="articles/rubias-overview.html">An Overview of rubias Usage</a></li>
    <li><a class="dropdown-item" href="articles/rubias-underlying-data-structures.html">An Explanation of the Underlying Data Structures in rubias</a></li>
    <li><a class="dropdown-item" href="articles/uncertainty-on-total-catch.html">Summarizing Uncertainty on Stock-Specific Total Catch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eriqande/rubias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Things to do to finish the package/paper/project</h1>
      <small class="dont-index">Source: <a href="https://github.com/eriqande/rubias/blob/HEAD/TODO.md" class="external-link"><code>TODO.md</code></a></small>
    </div>

<div id="things-to-do-to-finish-the-packagepaperproject" class="section level1">

<div class="section level2">
<h2 id="package">Package<a class="anchor" aria-label="anchor" href="#package"></a></h2>
<div class="section level3">
<h3 id="overarching-package-issues">Overarching Package Issues<a class="anchor" aria-label="anchor" href="#overarching-package-issues"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked>Puzzle over why the BH approach gave such different results on the Alewife SNPs than the vanilla MCMC-and-add-em-up approach. Ben check that to see if the misassignment factor is still in there.<br>
If it is, it might be nice to remove and then we can check again before removing the BH stuff. <strong>BEN</strong></label></li>
<li><label><input type="checkbox" checked>Unless there is a good reason to, I think we should remove the BH stuff from our three or four high level functions. Before we do this, Eric wants to make sure it is giving the same results as summing the MCMC. (see next item)</label></li>
<li><label><input type="checkbox" checked>Re-run alewife SNP stuff. <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked>The <em>main functions</em> that users should have to deal with are <code><a href="reference/infer_mixture.html">infer_mixture()</a></code>, <code>simulate_and_assess_reference()</code> (maybe we should shorten that to <code><a href="reference/assess_reference_loo.html">assess_reference_loo()</a></code>), <code>assess_bp_bias_correction()</code>, and we need one that is <code><a href="reference/self_assign.html">self_assign()</a></code>, and <code>assess_reference_mccv()</code> These all should spit out tidy data, to the extent possible. We should try to expose very few other functions.<br></label></li>
<li><label><input type="checkbox" checked>Clean up code so that it is CRAN compliant. Run Check to see all the problems. We get a lot of NOTEs and a number of WARNINGs. <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked>Use <code>if(getRversion() &gt;= "2.15.1") utils::globalVariables(c("my_var"))</code> to keep CRAN checks from creating notes for variable <code>my_var</code> used in a dplyr context. Do this for all variables that create NOTEs <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked>Deprecate the old “pipeline functions” that have been superseded by the ones in <code>eca_funcs.R</code>. Use the .Deprecated Just internalize them. <strong>BEN</strong> function <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Deprecated.html" class="external-link">here</a>. We want to keep them around for a few iterations for getting results for the paper, but a lot of the paper stuff needed to come out of them. <strong>BEN</strong></label></li>
<li><label><input type="checkbox" checked>Update documentation to reflect the deprecation, and update the documentation for the <em>main functions</em></label></li>
<li><label><input type="checkbox" checked>Discuss transferring “ownership” of the repo to Eric’s GitHub account.</label></li>
<li><label><input type="checkbox" checked>Set Travis-CI up to automatically run CRAN checks. <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked>Write a README.Rmd that shows all the different uses of the package in an easy, step-by-step, beginner’s mind way. This will eventually turn into a vignette. <strong>ERIC</strong> and <strong>BEN</strong>.</label></li>
<li><label><input type="checkbox" checked>Minimize the number of functions that are exported and, hence, exposes to the user. In the roxygen block for these functions add a line: <code>#' @keywords internal</code> to keep the function documentation out of the help files (if users aren’t going to use them directly, there is no reason to have them.) <strong>BEN</strong>.</label></li>
</ul></div>
<div class="section level3">
<h3 id="specific-functions-and-issues">Specific Functions and Issues<a class="anchor" aria-label="anchor" href="#specific-functions-and-issues"></a></h3>
<ul class="task-list"><li><label><input type="checkbox" checked>What is going on with these lines <a href="https://github.com/benmoran11/rubias/blob/64a1ba2fcaa1471fc338d37d87abe94bf0655ac6/R/data_conversion.R#L385-L387" class="external-link">here</a>. That looks like dynamite, potentially—it is rearranging factor levels if things are already a factor. Did we just decide that we would take either a factor or a string as input in those columns and always return characters in the output? Hmmm….Eric has looked this over more now and it seems that we must have decided to internally do all the calculations with a particular ordering of the data. But, we should be careful that if things were factors on input that they get returned with the same levels in the same order.<br></label></li>
<li><label><input type="checkbox" checked>We need a simple function that will take a reference data set in and return a tidy-formatted output that includes self-assignment log-likelihoods and posterior probabilities in tidy format. Let’s call this <code><a href="reference/self_assign.html">self_assign()</a></code>.</label></li>
<li><label><input type="checkbox" checked>It would be nice to modify <code>infer_mixture</code> so that multiple different mixture samples can be specified in a single data frame input. With really large baselines, the vast majority of the time in the function is spent processing the data, counting alleles, etc., and it is a shame to have to do this each time you want to analyze a different mixture sample. I’m not sure how to go about this, but Ben might! <strong>BEN looked into it, will start on new version</strong></label></li>
<li><label><input type="checkbox" checked>Try to make almost all user-exposed functions return tidy data. For example <code>infer_mixture</code> returns a list at the moment. Can that be cleaned up. <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked>We could really use a way for users to have more control over the simulation parameters—just setting alpha is pretty limited. It would be nice for users to explicitly give proportions (or maybe even the actual counts). For this we need to spend some time thinking about how to do it elegantly. <strong>ERIC</strong></label></li>
<li><label><input type="checkbox" checked><strong>BEN</strong>: <code>assess_bp_bias_correction</code> spits out some nice tidy data at this point. It looks like:</label></li>
</ul><pre><code># A tibble: 700 × 6
    iter     repunit   true_rho   rho_mcmc     rho_bh     rho_pb
   &lt;int&gt;      &lt;fctr&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;
1      1         CAN 0.04573827 0.06489907 0.04550360 0.06226238
2      1         NNE 0.06962820 0.07385272 0.05886538 0.06360804
3      1          MB 0.14588315 0.21344097 0.21242781 0.22291767
4      1         NUN 0.46891013 0.14646259 0.35338886 0.24710874
5      1         BIS 0.06644381 0.09336929 0.15767998 0.08005169
6      1         LIS 0.15719031 0.35012560 0.11664560 0.27002139
7      1 MidAtlantic 0.04620614 0.05784975 0.05548877 0.05403009
8      2         CAN 0.02751659 0.02866411 0.02224521 0.02645824
9      2         NNE 0.23190134 0.27633524 0.20446014 0.26219858
10     2          MB 0.16320168 0.07701908 0.17914736 0.11657221</code></pre>
<p>But, we need to + [x] remove the <code>rho_bh</code> calculation and the <code>rho_bh</code> column in the output. + [x] include a <code>true_n</code> column in the output, which gives the actual number of individuals sampled into that population on that iteration.</p>
<ul class="task-list"><li><label><input type="checkbox" checked>Figure out what happens when the simulation breaks during the Monte Carlo cross validation. <strong>BEN</strong></label></li>
<li><label><input type="checkbox" checked>We need a Monte Carlo cross-validation function. The inputs and outputs should be like <code>assess_reference</code>, so Eric still needs to clean that up a bit. <strong>Ben after eric pulls together the loo version</strong></label></li>
<li><label><input type="checkbox" checked>Prune the EM-stuff out of `<code>assess_reference</code>. <strong>ERIC</strong></label></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="paper">Paper<a class="anchor" aria-label="anchor" href="#paper"></a></h2>
<ul class="task-list"><li><label><input type="checkbox" checked>Eric needs to talk to Eric P. about the possibility of using the alewife SNP data as an example.</label></li>
<li><label><input type="checkbox" checked>Do the parametric bootstrapping on a few other data sets to show that it doesn’t break anything, and it usually improves them.</label></li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric C. Anderson, Ben Moran.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

