<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate mixtures and estimate reporting group and collection proportions. — assess_reference_loo • rubias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate mixtures and estimate reporting group and collection proportions. — assess_reference_loo"><meta name="description" content="From a reference dataset, this creates a genotype-logL matrix based on
simulation-by-individual with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from
MCMC."><meta property="og:description" content="From a reference dataset, this creates a genotype-logL matrix based on
simulation-by-individual with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from
MCMC."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rubias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rubias-fully-bayesian.html">Using the Fully Bayesian Model in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-overview.html">An Overview of rubias Usage</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-underlying-data-structures.html">An Explanation of the Underlying Data Structures in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty-on-total-catch.html">Summarizing Uncertainty on Stock-Specific Total Catch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eriqande/rubias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate mixtures and estimate reporting group and collection proportions.</h1>
      <small class="dont-index">Source: <a href="https://github.com/eriqande/rubias/blob/HEAD/R/assess_reference_loo.R" class="external-link"><code>R/assess_reference_loo.R</code></a></small>
      <div class="d-none name"><code>assess_reference_loo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>From a reference dataset, this creates a genotype-logL matrix based on
simulation-by-individual with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from
MCMC.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assess_reference_loo</span><span class="op">(</span></span>
<span>  <span class="va">reference</span>,</span>
<span>  <span class="va">gen_start_col</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  mixsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  alpha_repunit <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  alpha_collection <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  resampling_unit <span class="op">=</span> <span class="st">"individual"</span>,</span>
<span>  alle_freq_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>const_scaled <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  printSummary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_indiv_posteriors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>a two-column format genetic dataset, with "repunit", "collection", and "indiv"
columns, as well as a "sample_type" column that has some "reference" entries</p></dd>


<dt id="arg-gen-start-col">gen_start_col<a class="anchor" aria-label="anchor" href="#arg-gen-start-col"></a></dt>
<dd><p>the first column of genetic data in <code>reference</code></p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>number of reps of mixture simulation and MCMC to do</p></dd>


<dt id="arg-mixsize">mixsize<a class="anchor" aria-label="anchor" href="#arg-mixsize"></a></dt>
<dd><p>the number of individuals in each simulated mixture</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>a random seed for simulations</p></dd>


<dt id="arg-alpha-repunit">alpha_repunit<a class="anchor" aria-label="anchor" href="#arg-alpha-repunit"></a></dt>
<dd><p>If a vector, this is the dirichlet parameter for simulating
the proportions of reporting units. Gets recycled to the number of reporting units. Default is 1.5.
Otherwise, this could be a two-column data frame.  The first column must be named "repunit" and the
second one must be one of "dirichlet", "ppn", or "cnt", according to whether you wish to
specify dirichlet parameters, or proportions, or exact counts, respectively, for each population.
If you want to make multiple simulations, pass in a list of data frames or of individual dirichlet parameters.
For examples, see <code><a href="sim_spec_examples.html">sim_spec_examples</a></code>.</p></dd>


<dt id="arg-alpha-collection">alpha_collection<a class="anchor" aria-label="anchor" href="#arg-alpha-collection"></a></dt>
<dd><p>The dirichlet parameter for simulating proportions of collections within reporting units. Default = 1.5.
If this is a data frame then the first column must be "collection" and the second must be one of
"dirichlet", "ppn", "cnt", "sub_dirichlet", "sub_ppn".  If you want to provide multiple different
scenarios.  You can pass them in as a list.  If alpha_repunit or alpha_collection is a list with length
greater than 1, the shorter will be recycled.
For examples, see <code><a href="sim_spec_examples.html">sim_spec_examples</a></code>.</p></dd>


<dt id="arg-resampling-unit">resampling_unit<a class="anchor" aria-label="anchor" href="#arg-resampling-unit"></a></dt>
<dd><p>what unit should be resampled.  Currently the choices are "individuals" (the default)
and "gene_copies".  Using "individuals" preserves missing data patterns available in the reference data set.
We also have "gene_copies_with_missing" capability, but it is not yet linked into this function.</p></dd>


<dt id="arg-alle-freq-prior">alle_freq_prior<a class="anchor" aria-label="anchor" href="#arg-alle-freq-prior"></a></dt>
<dd><p>a one-element named list specifying the prior to be used when
generating Dirichlet parameters for genotype likelihood calculations. Valid methods include
<code>"const"</code>, <code>"scaled_const"</code>, and <code>"empirical"</code>. See <code><a href="list_diploid_params.html">?list_diploid_params</a></code>
for method details.</p></dd>


<dt id="arg-printsummary">printSummary<a class="anchor" aria-label="anchor" href="#arg-printsummary"></a></dt>
<dd><p>if TRUE a summary of the reference samples will be printed to stdout.</p></dd>


<dt id="arg-return-indiv-posteriors">return_indiv_posteriors<a class="anchor" aria-label="anchor" href="#arg-return-indiv-posteriors"></a></dt>
<dd><p>if TRUE, output is a list of 2. The first entry, <code>mixing_proportions</code>,
contains the true (simulated) and estimated mixture proportions for each scenario, iteration, and collection.
The second, <code>indiv_posteriors</code>, contains the posterior probability of assignment to each collection
for each scenario, iteration, and individual. If FALSE, output is a single data frame, <code>mixing_proportions</code></p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># very small number of reps so it is quick enough for example</span></span></span>
<span class="r-in"><span><span class="va">ale_dev</span> <span class="op">&lt;-</span> <span class="fu">assess_reference_loo</span><span class="op">(</span><span class="va">alewife</span>, <span class="fl">17</span>, reps <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ++++ Starting in on repunit_scenario 1 with collection scenario 1 ++++</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Doing LOO simulations rep 1 of 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Doing LOO simulations rep 2 of 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Doing LOO simulations rep 3 of 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Doing LOO simulations rep 4 of 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Doing LOO simulations rep 5 of 5</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric C. Anderson, Ben Moran.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

