<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Partition a reference dataset and estimate reporting group and collection proportions — assess_reference_mc • rubias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partition a reference dataset and estimate reporting group and collection proportions — assess_reference_mc"><meta name="description" content="From a reference dataset, this draws (without replacement) a simulated mixture
dataset with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from MCMC."><meta property="og:description" content="From a reference dataset, this draws (without replacement) a simulated mixture
dataset with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from MCMC."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rubias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rubias-fully-bayesian.html">Using the Fully Bayesian Model in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-overview.html">An Overview of rubias Usage</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-underlying-data-structures.html">An Explanation of the Underlying Data Structures in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty-on-total-catch.html">Summarizing Uncertainty on Stock-Specific Total Catch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eriqande/rubias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Partition a reference dataset and estimate reporting group and collection proportions</h1>
      <small class="dont-index">Source: <a href="https://github.com/eriqande/rubias/blob/HEAD/R/assess_reference_mc.R" class="external-link"><code>R/assess_reference_mc.R</code></a></small>
      <div class="d-none name"><code>assess_reference_mc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>From a reference dataset, this draws (without replacement) a simulated mixture
dataset with randomly drawn population proportions,
then uses this in two different estimates of population mixture proportions:
maximum likelihood via EM-algorithm and posterior mean from MCMC.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assess_reference_mc</span><span class="op">(</span></span>
<span>  <span class="va">reference</span>,</span>
<span>  <span class="va">gen_start_col</span>,</span>
<span>  reps <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  mixsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  alpha_repunit <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  alpha_collection <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  min_remaining <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  alle_freq_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>const_scaled <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>a two-column format genetic dataset, with "repunit", "collection", and "indiv"
columns, as well as a "sample_type" column that has some "reference" entries.</p></dd>


<dt id="arg-gen-start-col">gen_start_col<a class="anchor" aria-label="anchor" href="#arg-gen-start-col"></a></dt>
<dd><p>the first column of genetic data in reference</p></dd>


<dt id="arg-reps">reps<a class="anchor" aria-label="anchor" href="#arg-reps"></a></dt>
<dd><p>number of reps to do</p></dd>


<dt id="arg-mixsize">mixsize<a class="anchor" aria-label="anchor" href="#arg-mixsize"></a></dt>
<dd><p>the number of individuals in each simulated mixture.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>a random seed for simulations</p></dd>


<dt id="arg-alpha-repunit">alpha_repunit<a class="anchor" aria-label="anchor" href="#arg-alpha-repunit"></a></dt>
<dd><p>The dirichlet parameter for simulating the proportions of
reporting units. Default = 1.5</p></dd>


<dt id="arg-alpha-collection">alpha_collection<a class="anchor" aria-label="anchor" href="#arg-alpha-collection"></a></dt>
<dd><p>The dirichlet parameter for simulating proportions of collections
within reporting units. Default = 1.5</p></dd>


<dt id="arg-min-remaining">min_remaining<a class="anchor" aria-label="anchor" href="#arg-min-remaining"></a></dt>
<dd><p>the minimum number of individuals which should be conserved in
each reference collection during sampling without replacement to form the simulated mixture</p></dd>


<dt id="arg-alle-freq-prior">alle_freq_prior<a class="anchor" aria-label="anchor" href="#arg-alle-freq-prior"></a></dt>
<dd><p>a one-element named list specifying the prior to be used when
generating Dirichlet parameters for genotype likelihood calculations. Valid methods include
<code>"const"</code>, <code>"scaled_const"</code>, and <code>"empirical"</code>. See <code><a href="list_diploid_params.html">?list_diploid_params</a></code>
for method details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This method is referred to as "Monte Carlo cross-validation".
The input parameters for <code>assess_reference_mc</code> are more restrictive than those of
<code>assess_reference_loo</code>. Rather than allowing a <em>data.frame</em> to specify Dirichlet
parameters, proportions, or counts for specific reporting units and collections,
<code>assess_reference_mc</code> only allows vector input (default = 1.5) for <code>alpha_repunit</code>
and <code>alpha_collection</code>. These inputs specify the uniform Dirichlet parameters for
all reporting units and collections, respectively.</p>
<p>For mixture proportion generation, the rho values are first drawn using a stick-breaking
model of the Dirichlet distribution, but with proportions capped by <code>min_remaining</code>.
Stick-breaking is then used to subdivide each reporting unit into collections. In
addition to the constraint that mixture sampling without replacement cannot deplete
the number of individuals in each collection below <code>min_remaining</code>, a similar
constraint is placed upon the number of individuals left in reporting units,
determined as <code>min_remaining</code> * (# collections in reporting unit).</p>
<p>Note that this implies that the data are only truly Dirichlet distributed when no
rejections based on <code>min_remaining</code> occur. This is a reasonable certainty with
sufficient reference collection sizes relative to the desired mixture size.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># only 5 reps, so it doesn't take too long.  Typically you would</span></span></span>
<span class="r-in"><span><span class="co"># do many more</span></span></span>
<span class="r-in"><span><span class="va">ale_dev</span> <span class="op">&lt;-</span> <span class="fu">assess_reference_mc</span><span class="op">(</span><span class="va">alewife</span>, <span class="fl">17</span>, <span class="fl">5</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric C. Anderson, Ben Moran.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

