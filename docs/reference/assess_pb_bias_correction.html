<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Test the effects of the parametric bootstrap bias correction on a reference dataset through cross-validation — assess_pb_bias_correction • rubias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Test the effects of the parametric bootstrap bias correction on a reference dataset through cross-validation — assess_pb_bias_correction"><meta name="description" content="This is a rewrite of bias_comparison().  Eric didn't want the plotting to
be wrapped up in a function, and wanted to return a more informative data
frame."><meta property="og:description" content="This is a rewrite of bias_comparison().  Eric didn't want the plotting to
be wrapped up in a function, and wanted to return a more informative data
frame."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rubias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rubias-fully-bayesian.html">Using the Fully Bayesian Model in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-overview.html">An Overview of rubias Usage</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-underlying-data-structures.html">An Explanation of the Underlying Data Structures in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty-on-total-catch.html">Summarizing Uncertainty on Stock-Specific Total Catch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eriqande/rubias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Test the effects of the parametric bootstrap bias correction on a reference dataset through cross-validation</h1>
      <small class="dont-index">Source: <a href="https://github.com/eriqande/rubias/blob/HEAD/R/assess_pb_bias_correction.R" class="external-link"><code>R/assess_pb_bias_correction.R</code></a></small>
      <div class="d-none name"><code>assess_pb_bias_correction.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a rewrite of bias_comparison().  Eric didn't want the plotting to
be wrapped up in a function, and wanted to return a more informative data
frame.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">assess_pb_bias_correction</span><span class="op">(</span></span>
<span>  <span class="va">reference</span>,</span>
<span>  <span class="va">gen_start_col</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  nreps <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  mixsize <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  alle_freq_prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>const_scaled <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-reference">reference<a class="anchor" aria-label="anchor" href="#arg-reference"></a></dt>
<dd><p>a two-column format genetic dataset, with a "repunit" column
specifying each individual's reporting unit of origin, a "collection" column
specifying the collection (population or time of sampling) and "indiv" providing
a unique name</p></dd>


<dt id="arg-gen-start-col">gen_start_col<a class="anchor" aria-label="anchor" href="#arg-gen-start-col"></a></dt>
<dd><p>the first column containing genetic data in <code>reference</code>.
All columns should be genetic format following this column, and gene copies from the
same locus should be adjacent</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>the random seed for simulations</p></dd>


<dt id="arg-nreps">nreps<a class="anchor" aria-label="anchor" href="#arg-nreps"></a></dt>
<dd><p>The number of reps to do.</p></dd>


<dt id="arg-mixsize">mixsize<a class="anchor" aria-label="anchor" href="#arg-mixsize"></a></dt>
<dd><p>The size of each simulated mixture sample.</p></dd>


<dt id="arg-alle-freq-prior">alle_freq_prior<a class="anchor" aria-label="anchor" href="#arg-alle-freq-prior"></a></dt>
<dd><p>a one-element named list specifying the prior to be used when
generating Dirichlet parameters for genotype likelihood calculations. Valid methods include
<code>"const"</code>, <code>"scaled_const"</code>, and <code>"empirical"</code>. See
<code><a href="list_diploid_params.html">?list_diploid_params</a></code> for method details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>bias_comparison</code> returns a list; the first element is
a list of the relevant rho values generated on each iteration of the random "mixture"
creation. This includes the true rho value, the standard result <code>rho_mcmc</code>,
and the parametric bootstrapped <code>rho_pb</code>.</p>
<p>The second element is a dataframe listing summary statistics for each
reporting unit and estimation method. <code>mse</code>, the mean squared error, summarizes
the deviation of the rho estimates from their true value, including both bias and other variance.
<code>mean_prop_bias</code> is the average ratio of residual to true value, which gives greater
weight to deviations at smaller values. <code>mean_bias</code> is simply the average residual;
unlike <code>mse</code>, this demonstrates the direction of the bias.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Takes a reference two-column genetic dataset, pulls a series of random
"mixture" datasets with varying reporting unit proportions from this reference,
and compares the results of GSI through standard MCMC
vs. parametric-bootstrap MCMC bias correction</p>
<p>The amount of bias in reporting unit proportion calculations increases with the
rate of misassignment between reporting units (decreases with genetic differentiation),
and increases as the number of collections within reporting units becomes more uneven.</p>
<p>Output from the standard Bayesian MCMC method demonstrates the level of bias to be
expected for the input data set, and parametric bootstrapping is an empirical method
for the removal of any existing bias.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## This takes too long to run in R CMD CHECK</span></span></span>
<span class="r-in"><span><span class="va">ale_bias</span> <span class="op">&lt;-</span> <span class="fu">assess_pb_bias_correction</span><span class="op">(</span><span class="va">alewife</span>, <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric C. Anderson, Ben Moran.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

