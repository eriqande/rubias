<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Convert Two-Column Genetic Data to Long Format — tcf2long • rubias</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Convert Two-Column Genetic Data to Long Format — tcf2long"><meta name="description" content="Takes a data frame consisting of metadata followed by paired columns of genetic data,
with each column in the pair representing a gene copy at a locus.
Returns a list of two data frames: one with genetic data condensed into one column,
and the other with two-column structure intact, but with cleaned allele names."><meta property="og:description" content="Takes a data frame consisting of metadata followed by paired columns of genetic data,
with each column in the pair representing a gene copy at a locus.
Returns a list of two data frames: one with genetic data condensed into one column,
and the other with two-column structure intact, but with cleaned allele names."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rubias</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rubias-fully-bayesian.html">Using the Fully Bayesian Model in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-overview.html">An Overview of rubias Usage</a></li>
    <li><a class="dropdown-item" href="../articles/rubias-underlying-data-structures.html">An Explanation of the Underlying Data Structures in rubias</a></li>
    <li><a class="dropdown-item" href="../articles/uncertainty-on-total-catch.html">Summarizing Uncertainty on Stock-Specific Total Catch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eriqande/rubias/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Convert Two-Column Genetic Data to Long Format</h1>
      <small class="dont-index">Source: <a href="https://github.com/eriqande/rubias/blob/HEAD/R/data_conversion.R" class="external-link"><code>R/data_conversion.R</code></a></small>
      <div class="d-none name"><code>tcf2long.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a data frame consisting of metadata followed by paired columns of genetic data,
with each column in the pair representing a gene copy at a locus.
Returns a list of two data frames: one with genetic data condensed into one column,
and the other with two-column structure intact, but with cleaned allele names.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tcf2long</span><span class="op">(</span><span class="va">D</span>, <span class="va">gen_start_col</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">D<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>A data frame containing two-column genetic data, optionally preceded by metadata.
The header of the first genetic data column in each pair lists the locus name, the second is ignored.
<strong>Locus names must not have spaces in them!</strong></p></dd>


<dt id="arg-gen-start-col">gen_start_col<a class="anchor" aria-label="anchor" href="#arg-gen-start-col"></a></dt>
<dd><p>The index (number) of the column in which genetic data starts.
Columns must be only genetic data after genetic data starts.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>tcf2long</code> returns a list of two data frames: in the first, "long", the rightmost
column is the genetic data. Two new columns, "locus" and "gene copy", duplicate the original
column name provided in the first of each pair, and designate copies "a" and "b", respectively.
Metadata is duplicated as necessary for each locus. The second, "clean_short", replicates the
input dataset, but with column names replaced by "(locus name) a" and "(locus name) b" in each pair.
In other words the locus name has an "a" or a "b" added to it <em>after a space</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Convert the alewife dataset for further processing</span></span></span>
<span class="r-in"><span><span class="co"># the data frame passed into this function must have had</span></span></span>
<span class="r-in"><span><span class="co"># character collections and repunits converted to factors</span></span></span>
<span class="r-in"><span><span class="va">reference</span> <span class="op">&lt;-</span> <span class="va">alewife</span></span></span>
<span class="r-in"><span><span class="va">reference</span><span class="op">$</span><span class="va">repunit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">reference</span><span class="op">$</span><span class="va">repunit</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">reference</span><span class="op">$</span><span class="va">repunit</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">reference</span><span class="op">$</span><span class="va">collection</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">reference</span><span class="op">$</span><span class="va">collection</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">reference</span><span class="op">$</span><span class="va">collection</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ale_long</span> <span class="op">&lt;-</span> <span class="fu">tcf2long</span><span class="op">(</span><span class="va">reference</span>, <span class="fl">17</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Eric C. Anderson, Ben Moran.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

